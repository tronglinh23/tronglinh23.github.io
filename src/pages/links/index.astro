---
import BaseLayout from '@/layouts/BaseLayout.astro';
import { getCollection } from 'astro:content';
import TagPill from '@/components/TagPill.astro';
import { formatDate } from '@/lib/utils';

const links = (await getCollection('links')).filter((p) => !p.data.draft).sort((a,b)=>b.data.date - a.data.date);
---

<BaseLayout title="Research" description="Curated articles, papers, and references from around the web.">
  <div class="mb-6">
    <h1 class="text-3xl font-semibold text-white/95">Research</h1>
    <p class="mt-2 text-white/70">
      Curated articles, research notes, and references. Think of this as your reading radar.
    </p>
  </div>

  <div class="grid gap-4">
    {links.map((p) => (
      <a
        href={p.data.source_url}
        target="_blank"
        rel="noreferrer"
        class="block rounded-3xl border border-white/10 bg-white/5 p-5 shadow-glass transition hover:border-white/20 hover:bg-white/10"
      >
        <div class="text-sm text-white/55">{formatDate(p.data.date)} · {p.data.category}</div>
        <h3 class="mt-2 text-lg font-semibold text-white/90">{p.data.title}</h3>
        <p class="mt-2 text-sm text-white/70">{p.data.description}</p>
        <div class="mt-4 flex flex-wrap gap-2">
          {(p.data.tags ?? []).slice(0, 8).map((t) => <TagPill tag={t} link={false} />)}
        </div>
        <div class="mt-4 text-sm text-white/70">Open ↗</div>
      </a>
    ))}
  </div>
</BaseLayout>
