---
title: Code patterns that often hide auth bugs
description: "A mini-catalog of web patterns: 'trusting client state', 'shadow admin endpoints', and more."
date: 2025-12-20
tags:
  - web
  - auth
  - pitfalls
  - security
category: web
draft: false
---

import Callout from '@/components/mdx/Callout.astro';
import Spoiler from '@/components/mdx/Spoiler.astro';

## Pattern 1: Trusting client state

If the server accepts:
- role in JWT without re-check
- `is_admin=true` in cookies
- user id in hidden form fields

…it’s suspicious.

<Spoiler summary="Show a tiny example">
```http
POST /transfer
Cookie: uid=1001; is_admin=true
```

If the backend uses `is_admin` cookie directly, it's game over.
</Spoiler>

## Pattern 2: "Shadow" admin endpoints

Sometimes you see:
- `/internal/...`
- `/debug/...`
- `/__admin/...`

Often not linked in UI, but still routable.

<Callout type="warning" title="CTF trick">
Even when “admin server” isn’t directly reachable, you may be able to influence its requests via queues, caches, SSRF or shared storage.
</Callout>

## Pattern 3: Inconsistent authorization

The UI hides buttons, but the API doesn't enforce ACLs.

**Test:** call the underlying endpoint directly with a low-priv user.

## Pattern 4: The reset-token lottery

If tokens are:
- short, predictable
- not bound to user or session
- re-usable

…you can often brute or replay.
