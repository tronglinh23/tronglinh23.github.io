---
title: Artifact Of Dangerous Sighting
description: 'Created: January 9, 2025 3:54 AM'
date: 2026-01-03
tags:
  - vhdx
  - log for
category: for
draft: false
---

import Callout from '@/components/mdx/Callout.astro';

Created: January 9, 2025 3:54 AM

<Callout type="note" title="Note">
ðŸ’¡

Hint: VHDX, security logs.

</Callout>

- Open Event Viewer, search for process `powershell.exe` â‡’ detect `tasks/hidden.ps1`.
- Open file `hidden.ps1` â‡’ base64 decode.

<Callout type="note" title="Note">
ðŸ’¡

```powershell
${[~@} = $();
${!!@!!]} = ++${[~@};
${[[!} = --${[~@} + ${!!@!!]} + ${!!@!!]};
${~~~]} = ${[[!} + ${!!@!!]};
${[!![!} = ${[[!} + ${[[!};
${(~(!} = ${~~~]} + ${[[!};
${!~!))} = ${[!![!} + ${[[!};
${((!} = ${!!@!!]} + ${[!![!} + ${[[!};
${=!!@!!} Â = ${~~~]} - ${!!@!!]} + ${!~!))};
${!=} = Â ${((!} - ${~~~]} + ${!~!))} - ${!!@!!]};
${=@!~!} = ""("$(@{})"[14]+"$(@{})"[16]+"$(@{})"[21]+"$(@{})"[27]+"$?"[1]+"$(@{})"[3]);
${=@!~!} = "$(@{})"[14]+"$?"[3]+"${=@!~!}"[27];
${@!=} = "["+"$(@{})"[7]+"$(@{})"[22]+"$(@{})"[20]+"$?"[1]+"]";

echo ${[~@};
echo ${!!@!!]};
echo ${[[!};
echo ${~~~]};
echo ${[!![!};
echo ${(~(!};
echo ${!~!))};
echo ${((!};
echo ${=!!@!!};
echo ${!=};
echo ${=@!~!};01
echo ${@!=};0
```

</Callout>

![image.png](/uploads/artifact-of-dangerous-sighting/artifact-of-dangerous-sighting/image.png)

- Thay Ä‘á»•i file encrypt, deobfuscate láº§n ná»¯a:

```jsx
"[Char]35 + [Char]35 + [Char]35 + [Char]32 + [Char]46 + [Char]32 + [Char]32 + [Char]32 + [Char]32 + [Char]32 + [Char]46 + [Char]32 + [Char]32 + [Char]32 + [Char]32 + [Char]32 + [Char]32 + [Char]32 + [Char]46 + [Char]32 + [Char]32 + [Char]46 + [Char]32 + [Char]32 + [Char]32 + [Char]46 + [Char]32 + [Char]46 + [Char]32 + [Char]32 + [Char]32 + [Char]46 + [Char]32 + [Char]32 + [Char]32 + [Char]46 + [Char]32 + [Char]46 + [Char]32 + [Char]32 + [Char]32 + [Char]32 + [Char]43 + [Char]32 + [Char]32 + [Char]46 + [Char]10 + [Char]35 + [Char]35 + [Char]35 + [Char]32 + [Char]32 + [Char]32 + [Char]46 + [Char]32 + [Char]32 + [Char]32 + [Char]32 + [Char]32 + [Char]46 + [Char]32 + [Char]32 + [Char]58 + [Char]32 + [Char]32 + [Char]32 + [Char]32 + [Char]32 + [Char]46 + [Char]32 + [Char]32 + [Char]32 + [Char]32 + [Char]46 + [Char]46 + [Char]32 + [Char]58 + [Char]46 + [Char]32 + [Char]46 + [Char]95 + [Char]95 + [Char]95 + [Char]45 + [Char]45 + [Char]45 + [Char]45 + [Char]45 + [Char]45 + [Char]45 + [Char]45 + [Char]45 + [Char]95 + [Char]95 + [Char]95 + [Char]46 + [Char]10 + [Char]35 + [Char]35 + [Char]35 + [Char]32 + [Char]32 + [Char]32 + [Char]32 + [Char]32 + [Char]32 + [Char]32 + [Char]32 + [Char]46 + [Char]32 + [Char]32 + [Char]46 + [Char]32 + [Char]32 + [Char]32 + [Char]46 + [Char]32 + [Char]32 + [Char]32 + [Char]32 + [Char]46 + [Char]32 + [Char]32 + [Char]58 + [Char]46 + [Char]58 + [Char]46 + [Char]32 + [Char]95 + [Char]34 + [Char]46 + [Char]94 + [Char]32 + [Char]46 + [Char]94 + [Char]32 + [Char]94 + [Char]46 + [Char]32 + [Char]32 + [Char]39 + [Char]46 + [Char]46 + [Char]32 + [Char]58 + [Char]34 + [Char]45 + [Char]95 + [Char]46 + [Char]32 + [Char]46 + [Char]10 + [Char]35 + [Char]35 + [Char]35 + [Char]32 + [Char]32 + [Char]32 + [Char]32 + [Char]32 + [Char]46 + [Char]32 + [Char]32 + [Char]58 + [Char]32 + [Char]32 + [Char]32 + [Char]32 + [Char]32 + [Char]32 + [Char]32 + [Char]46 + [Char]32 + [Char]32 + [Char]46 + [Char]32 + [Char]32 + [Char]46 + [Char]58 + [Char]46 + [Char]46 + [Char]47 + [Char]58 + [Char]32 + [Char]32 + [Char]32 + [Char]32 + [Char]32 + [Char]32 + [Char]32 + [Char]32 + [Char]32 + [Char]32 + [Char]32 + [Char]32 + [Char]46 + [Char]32 + [Char]46 + [Char]94 + [Char]32 + [Char]32 + [Char]58 + [Char]46 + [Char]58 + [Char]92 + [Char]46 + [Char]10 + [Char]35 + [Char]35 + [Char]35 + [Char]32 + [Char]32 + [Char]32 + [Char]32 + [Char]....
```

![image.png](/uploads/artifact-of-dangerous-sighting/artifact-of-dangerous-sighting/image-1.png)
